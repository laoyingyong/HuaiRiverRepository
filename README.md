# 基于WebGIS的淮河水量水质监测系统
## 1.系统简介
### 1.1 开发背景
1. 淮河位于我国东部地区，介于长江和黄河之间，其干流流经河南、安徽、江苏三省。淮河流域地跨河南、湖北、安徽、江苏和山东五省，以废黄河为界，可以将其分为淮河水系和沂沭泗水系。
2. 淮河是洪涝灾害频发区，从古至今，治淮一直是一项重要的课题。同时，随着社会的发展，淮河也存在着水体污染问题。
3. 众所周知，水是生命之源。没有水，地球就是一颗死气沉沉的星球。作为我国的七大河之一，淮河的水量与水质，与无数人的健康、生命财产安全息息相关。在传统方式中，我们如果想要获取实时的水量、水质数据，可能需要到现场进行人工采集。在互联网技术时代，我们不必再那么麻烦了，只需要在相关地方建设水量、水质监测站。监测数据由监测设备自动采集，然后通过网络即时传送到相关的监测总站。如此一来，便保证了数据的及时性、准确性和有效性，同时大大地提高了效率。政府部门通过水量水质监测系统，可以更好地作出决策。环境工作者通过水量水质监测系统，可以及时地掌握环境的变化状况。普通群众通过水量水质监测系统，可以大概地知道险情，从而保障自身的生命财产安全。总而言之，开展水量水质监测，事关人类生存、经济发展、社会进步，是治国安邦的大事。
### 1.2 开发语言及环境
* 开发语言：java、javascript
* 开发环境：windows 10、IntelliJ IDEA 2018、Tomcat9.0.27、JDK 1.8
* 数据库:MySQL 5.6

### 1.3 系统所用到的技术
1.	后端：本系统后端的持久层技术使用的是Spring框架下的JdbcTemplate，web层和业务逻辑层没有使用框架，web层使用的是JAVA原生的Servlet API去编写的。数据库连接池技术使用的是阿里巴巴的druid。用到的JSON解析工具有jackson和fastjson，用于把数据变成json字符串响应给前台、解析中国环境监测总站返回来的json数据。用到的HTML解析器为JSoup，用于解析淮河水文局网站上的数据。

2.	前端：HTML、CSS、JavaScript、jQuery、Bootstrap、jQuery UI、OpenLayers、Echarts等等。

###	1.4 如何部署该项目
1. 因为是第一次上传项目到GitHub，所以还不是很熟练，为了方便，我直接git add . ，把IDEA编译生成的文件也一起上传上来了。项目的源码在“rivermodule”目录里面，其他目录可以不用理会。
2. 这是一个普通的web工程，不是Maven工程，所以部署项目时无需Maven环境。
3. 在IntelliJ IDEA中配置好Tomcat服务器就可以运行了，当然前提得有JDK环境。版本不要过低就行了，可以参考我使用的版本，也可以使用更高的版本。
4. 因为设置有过滤器Filter，所以没有登录是不能访问大部分的资源的。要想登录，需要把数据库创建出来，并创建相应的数据库表，保存有相应的用户记录才行。


## 2.更新日志
2020-01-19 

- 舍弃了昂贵的API接口，使用“中国环境监测总站”上面的数据，使得数据更加及时、准确和有效，最重要的是免费的！
- 修改了数据库表的结构，这就意味着后端的“三层架构”中的代码都需要修改，同时，前端的代码也需要修改。

2020-01-21 

- 经过很长时间的注释测试，终于修复了前端地图界面一个严重的bug：精准点击popup图标反而无法弹出信息，要点击图标下方一定距离区域才能弹出信息。
- 问题出现的原因：jQuerey UI框架的对话框导致的，把对话框直接放入地图中容器div中，则会出现此问题。
- 解决办法：把jQuery UI 对话框放到地图容器div外面。

 2020-02-03 

* 界面初始化时查询数据库，直接把所有的监测站显示在地图上，而不是用户点击一个按钮，就显示一个监测站在地图上。
* 每点击一个监测站，就获取点击位置的经纬度，把经纬度作为请求参数，向服务器发起Ajax请求。服务器响应回来监测站的信息以及对应的最新的水质数据信息，前台负责把拿到的json数据显示到界面上。
* 新增预警功能，可以把最近两天出现异常数据的监测站以特别地颜色显示在地图上。
* 可以在地图上绘制受污染的区域，并将这些区域的坐标字符串以文本的方式保存到数据库。前台也支持查询和删除受污染的区域。
* 优化了分页条，模仿百度分页条，做成“前5后4”的效果。

2020-02-04 

* 修复了在发起搜索之后，无法再查看实时水质信息的bug。经过对比分析，找出了问题出现的原因——直接选择table，然后调用jQuery的html()方法。改正的方法就是选择table的父元素div，再调用html()方法。
* 新增饼图和折线图。饼图可以直观的看出各类水质的占比，折线图则可以直观地看出水质的变化情况。



